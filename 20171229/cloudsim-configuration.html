<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta name="keywords" content="cloudsim 配置, 七月飞雪">
    <meta name="description" content="cloudsimCloudSim simulation toolkit works on the basis of porgramatic models that are designed by carefully studying the">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>cloudsim 配置 | 七月飞雪</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">七月飞雪</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>友情链接</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">七月飞雪</div>
        <div class="logo-desc">
            
            for love
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                友情链接
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewbox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/>
    </svg>
</a>
        
    </nav>

</header>





<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/1.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        cloudsim 配置
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/编程/" target="_blank">
                                <span class="chip bg-color">编程</span>
                            </a>
                        
                            <a href="/tags/电脑/" target="_blank">
                                <span class="chip bg-color">电脑</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/编程/" class="post-category" target="_blank">
                                编程
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2017-12-29
                </div>

                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="cloudsim"><a href="#cloudsim" class="headerlink" title="cloudsim"></a>cloudsim</h2><p>CloudSim simulation toolkit works on the basis of porgramatic models that are designed by carefully studying the behaviors of real world cloud system components. These are some of the models of CloudSim: Datacenter, Datacenterbroker, Host, Vm, VmScheduling, VMAllocation, Storage etc, few of these are abstract models and few are defined to its fullest. The abstract models are defined for enabling the extension of these models for user defined simulation scenarios.</p>
<h2 id="配置-cloudsim"><a href="#配置-cloudsim" class="headerlink" title="配置 cloudsim"></a>配置 cloudsim</h2><a id="more"></a>
<h3 id="配置-cloudsim-Eclipse"><a href="#配置-cloudsim-Eclipse" class="headerlink" title="配置 cloudsim(Eclipse)"></a>配置 cloudsim(Eclipse)</h3><ol>
<li><p>首先要下载 cloudsim 包,下载地址在这里:<a href="https://github.com/Cloudslab/cloudsim" target="_blank" rel="noopener">https://github.com/Cloudslab/cloudsim</a></p>
<p><img src="https://i.imgur.com/2SDU2Ln.png" alt><br><img src="https://i.imgur.com/7Ij6vKK.png" alt><br>下载后解压,把解压后的东西放到 eclipse 的 workspaces,方便使用,</p>
</li>
</ol>
<ol start="2">
<li>用 eclipse 打开项目,在菜单栏上 <code>File&gt;import</code><br>导入为一个 maven 项目,它会自动下载 pom.xml 里面的包,大家一般的错误就是缺少相应的依赖包:<br><img src="https://i.imgur.com/Te6s3kV.png" alt><br><img src="https://i.imgur.com/B9Gt6XT.png" alt><br>导入后就出现了项目,等下面的进度条走完就好了,<br><img src="https://i.imgur.com/BLCRhbw.png" alt><br><img src="https://i.imgur.com/G2gfEse.png" alt></li>
</ol>
<p>然后打开实例,直接运行即可</p>
<p style="color:red;font-size:50;">如果导入失败,可以尝试换一个工作区重新导入!</p>

<p><img src="https://i.imgur.com/96wF79f.png" alt><br><code>console</code> 里面的就是输出结果</p>
<h3 id="配置-cloudsim-idea"><a href="#配置-cloudsim-idea" class="headerlink" title="配置 cloudsim(idea)"></a>配置 cloudsim(idea)</h3><blockquote>
<p>这个比较好配置,直接导入即可</p>
</blockquote>
<ol>
<li>点击 open,打开我们的 cloudsim 文件夹即可<br><img src="https://i.imgur.com/6jCw12e.png" alt></li>
<li>打开后同样需要添加依赖,import changes 就好了<br><img src="https://i.imgur.com/r46XcoU.png" alt><br>添加好后,他已经是一个完整的项目了,可以直接运行<br><img src="https://i.imgur.com/Nvtw5dI.png" alt></li>
</ol>
<h2 id="依据-CloudSim-源代码介绍几个核心类："><a href="#依据-CloudSim-源代码介绍几个核心类：" class="headerlink" title="依据 CloudSim 源代码介绍几个核心类："></a>依据 CloudSim 源代码介绍几个核心类：</h2><pre class=" language-text"><code class="language-text">    (1)Cloudlet类：构建云环境下的任务。
    (2)DataCenter类：数据中心，提供虚拟化的网格资源，处理虚拟机信息的查询，包含虚拟机对资源的分配策略，云计算采用VMProvisioner处理虚拟机。
    (3)DataCenterBroker类：隐藏了虚拟机的管理，如创建、任务提交、虚拟机的销毁等。
    (4)Host类：扩展了机器对虚拟机除处理单元(PE)之外的参数分配策略，如带宽、存储空间、内存等，一台Host可对应多台虚拟机。
    (5)VirtualMachine类：虚拟机类，运行在Host上，与其它虚拟机共享资源，每台虚拟机由一个拥有者所有，可提交任务，并由VMScheduler类定制该虚拟机的调度策略。
    (6)VMScheduler类：虚拟机的调度策略，用来管理执行任务，实现了任务接口。
    (7)VMCharacteristics类：提供虚拟机描述。
    (8)VMMAllocationPolicy类：虚拟机监视器策略类，描述同一Host上的多台虚拟机共享资源的策略。
    (9)VMProvisioner类：实现数据中心的主机到虚拟机的映射。
</code></pre>
<p>1)<code>CloudInformationService.java（org.cloudbus.cloudsim.core）</code><br>   Cloudsim 中最重要的类之一，它在 CloudSim 的仿真过程中保存资源列表（在现实生活中作为数据库）。这个类实现了 processEvent（SimEvent）方法，在模拟过程中，它处理七个离散类别的事件。如果仔细分析所有基本示例，将调用 CloudSim.Init（）方法，该方法将初始化 CloudInformationService 类的实例。这个类实例提供的基本服务将注册新的资源，索引和它们的发现。</p>
<p>2) <code>DataCenter.java（org.cloudbus.cloudsim）</code>该类通过持有主机，处理元素（Pe）和存储为列表的实例来模仿真实数据中心的基础架构功能。同时，为了方便您的模型和地理位置的可用性，它将初始化 DataCenterCharacteristics。这个类还实现了自己的 processEvent（SimEvent）方法，在模拟过程中，它处理了二十七个默认离散事件类别，如资源信息收集，虚拟机生命周期，云端提交状态等。</p>
<p>3) <code>DataCenterBroker.java（org.cloudbus.cloudsim）</code><br>4) <code>CloudSimShutdown.java（org.cloudbus.cloudsim.core）</code><br>5) <code>NetDatacenterBroker.java（org.cloudbus.cloudsim.network.datacenter）</code><br>6) <code>Switch.java（org.cloudbus.cloudsim.network.datacenter）</code></p>
<p>在这里，在CloudSim文件夹中，有以下文件夹：</p>
<ol>
<li><strong>例子</strong>：这个文件夹还包含了各种基于场景的用例，这个基本上是一个非常简单的实现来演示如何使用这个模拟引擎。这些示例包含各种用例，从基于虚拟机的数据中心开始，模仿使用功耗感知模型有效处理其操作的真正数据中心的实际配置。所有这些例子都被归类为以下包/名称空间：<ol>
<li><strong>org.cloudbus.cloudsim.examples：</strong>与生成基础级别基础结构实现有关的基本示例。</li>
<li><strong>org.cloudbus.cloudsim.examples.network：</strong>包含与基于拓扑的数据中心模拟相关的各种使用案例。</li>
<li><strong>org.cloudbus.cloudsim.examples.network.datacenter：</strong>这个包支持<strong>“org.cloudbus.cloudsim.examples.network”</strong>这个软件包，并附加了一些模仿网络支持云系统数据中心的类。</li>
<li><strong>org.cloudbus.cloudsim.examples.power：</strong>包含与功耗感知用例相关的实现，是cloudsim功耗感知模型实现最有趣的实现之一。</li>
<li><strong>org.cloudbus.cloudsim.examples.power.random：</strong>包含用于支持数据中心中的绿色计算概念的各种Power模型的实现。</li>
<li><strong>org.cloudbus.cloudsim.examples.power.planetlab：</strong>这也包含类似的功率模型实现，但是用来测试仿真的数据是从planetlab中获得的。这意味着这套示例可以处理真实的数据。</li>
<li><strong>workload.planetlab：</strong>这个软件包包含了来自地球实验室的所有数据，它是一个数据明智的数据。这进一步被’org.cloudbus.cloudsim.examples.power.planetlab’包中定义的例子所消耗。</li>
</ol>
</li>
<li><strong>来源</strong>：该文件夹包含所有的模型类，支持cloudsim的模拟过程。这些模型根据其属性和行为进一步在各种包/名称空间中进行结构化。以下是可用的软件包：<ol>
<li><strong>org.cloudbus.cloudsim：</strong>包含与CPU，RAM，网络带宽等相关的DataCenter，Broker，Host，CPU，存储，资源，分配策略和利用模型相关的类的集合。</li>
<li><strong>org.cloudbus.cloudsim.core：</strong>包含云模拟引擎的支柱类，包括事件调度执行引擎，实体库定义，云信息服务等。</li>
<li><strong>org.cloudbus.cloudsim.core.predicates：</strong>这些类用于启用事件比较以及执行相应的事件。</li>
<li><strong>org.cloudbus.cloudsim.distributions：</strong>包含模拟过程中使用的各种标准数学分布的实现。</li>
<li><strong>org.cloudbus.cloudsim.lists：</strong>包含在主机，虚拟机，虚拟机等列表上执行的操作的实现。</li>
<li><strong>org.cloudbus.cloudsim.network：</strong>包含几个路由算法的实现，如：FloydWarshall，BRITE等</li>
<li><strong>org.cloudbus.cloudsim.network.datacenter：</strong>包含基于基于网络的数据中心模拟的与模型有关的类的实现。</li>
<li><strong>org.cloudbus.cloudsim.power：</strong>包含与功耗感知模型相关的数据中心，代理，主机，虚拟机和分配策略的扩展实现</li>
<li><strong>org.cloudbus.cloudsim.power.lists：</strong>仅包含启用了功耗感知数据中心模型的虚拟机的实现</li>
<li><strong>org.cloudbus.cloudsim.power.models：</strong>包含市场上可用的各种CPU模型的实现，并用于各种现实生活中的数据中心提供商。</li>
<li><strong>org.cloudbus.cloudsim.provisioners：</strong>包含CPU，RAM，带宽的供应程序的实施。</li>
<li><strong>org.cloudbus.cloudsim.util：</strong>包含在仿真过程中用于某些计算目的的一组类。</li>
</ol>
</li>
</ol>
<h2 id="CloudSimExample1-包含以下属性的声明和定义："><a href="#CloudSimExample1-包含以下属性的声明和定义：" class="headerlink" title="CloudSimExample1 包含以下属性的声明和定义："></a>CloudSimExample1 包含以下属性的声明和定义：</h2><ol>
<li><p><strong>CloudletList</strong>：<br>List <cloudlet>类型的静态变量。通过仿真过程它将包含云类的所有实例的列表。该列表被提交给 DataCenterBroker 的实例，以便分配给特定的 VM 用于执行目的。</cloudlet></p>
</li>
<li><p><strong>vmlist</strong>：一个 List <vm>类型的静态变量，在模拟过程中，它将包含 Vm 类的所有实例的列表。该列表还将被提交给 DataCenterBroker 的实例以分配用于执行的云实例。云块到 Vm 的映射可以是随机的或特定的。这取决于用例实现。</vm></p>
</li>
<li><p><strong>createBroker（）：</strong><br>此方法将创建并返回 DataCenterBroker 的实例。这个方法在 main 方法里面调用也是一个静态的方法。</p>
</li>
<li><p><strong>createDatacenter(String):</strong><br>该方法包含定义 DataCenter 配置的实现，该配置将用于在仿真过程中处理云的执行。此方法将数据中心名称作为名称，仅用于识别目的。在这个方法中，只有 DataCenterCharateristics 被定义了哪个实例实例化主机列表以及处理元素列表。这些列表以及存储列表，分配策略和 DataCenterCharacteristics 的实例将创建 DataCenter 实例并返回到主方法调用。</p>
</li>
<li><p><strong>printCloudletList(List<cloudlet>):</cloudlet></strong><br>一旦模拟结束，此方法用于打印模拟结果。</p>
</li>
<li><p><strong>main(string args[])</strong>：这个方法是一旦你点击运行按钮就被调用的第一个方法。此方法包含执行下面提到的所有步骤，并按顺序执行。此方法根据执行中的步骤在需要的时候向特定的方法发送一个调用。以下步骤解释了每个步骤及其代码：</p>
</li>
</ol>
<h3 id="第一步"><a href="#第一步" class="headerlink" title="第一步:"></a><strong>第一步:</strong></h3><p>Cloudsim 仿真将被初始化以进行仿真，并且这个仿真需要下面的信息来启动：</p>
<ul>
<li>number of user,</li>
<li>calendar instance </li>
<li>traceflag value.</li>
</ul>
<p>所有这些参数都需要初始化 Cloudsim 仿真过程，CloudSim.init()方法初始化并发送一个调用来创建一个 CloudInfromationService 实例（创建第一个实体）。下面的代码用于此：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">int</span> num_user <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// number of cloud users defined statically</span>
Calendar calendar <span class="token operator">=</span> Calendar<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">boolean</span> trace_flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// mean trace events</span>
CloudSim<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>num_user<span class="token punctuation">,</span> calendar<span class="token punctuation">,</span> trace_flag<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//初始化CloudSim工具包，它应该在创建任何实体之前调用</span>
</code></pre>
<h3 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a><strong>第二步</strong></h3><p>一个数据中心实例将被创建，这是通过一个单独的<code>CreateDataCenter</code>  完成的，这个实例创建了处理元素，主机，存储，成本和数据中心特性的实例。</p>
<pre class=" language-java"><code class="language-java">Datacenter datacenter0 <span class="token operator">=</span> <span class="token function">createDatacenter</span><span class="token punctuation">(</span><span class="token string">"Datacenter_0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>这反过来将调用发送到 <code>createDatacenter（）</code>方法的以下定义：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> Datacenter <span class="token function">createDatacenter</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 1.创建列表用于储存机器，简称主机列表</span>
    List<span class="token operator">&lt;</span>Host<span class="token operator">></span> hostList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>Host<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">//   2. 创建主机包含的PE或者CPU处理器列表</span>
    List<span class="token operator">&lt;</span>Pe<span class="token operator">></span> peList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>Pe<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> mips <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 3. 创建处理器，并添加到Pe列表中</span>
    peList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Pe</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PeProvisionerSimple</span><span class="token punctuation">(</span>mips<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> hostId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ram <span class="token operator">=</span> <span class="token number">2048</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// </span>
    <span class="token keyword">long</span> storage <span class="token operator">=</span> <span class="token number">1000000</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//主机容量</span>
    <span class="token keyword">int</span> bw <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 4. 创建主机，并将其添加至主机列表</span>
    hostList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token class-name">Host</span><span class="token punctuation">(</span>hostId<span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">RamProvisionerSimple</span><span class="token punctuation">(</span>ram<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">//内存提供者，为虚拟机提供内存</span>
                <span class="token keyword">new</span> <span class="token class-name">BwProvisionerSimple</span><span class="token punctuation">(</span>bw<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">//带宽提供者</span>
                storage<span class="token punctuation">,</span> peList<span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">VmSchedulerTimeShared</span><span class="token punctuation">(</span>peList<span class="token punctuation">)</span><span class="token comment" spellcheck="true">//时间共享的VM调度 ));</span>

        String arch <span class="token operator">=</span> <span class="token string">"x86"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// system architecture</span>
    String os <span class="token operator">=</span> <span class="token string">"Linux"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// operating system</span>
    String vmm <span class="token operator">=</span> <span class="token string">"Xen"</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> time_zone <span class="token operator">=</span> <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// time zone this resource located</span>
    <span class="token keyword">double</span> cost <span class="token operator">=</span> <span class="token number">3.0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// the cost of using processing in this resource</span>
    <span class="token keyword">double</span> costPerMem <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// the cost of using memory in this resource</span>
    <span class="token keyword">double</span> costPerStorage <span class="token operator">=</span> <span class="token number">0.001</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// the cost of using storage in this resource</span>
    <span class="token keyword">double</span> costPerBw <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// the cost of using bw in this resource</span>

    <span class="token comment" spellcheck="true">// we are not adding SAN devices by no</span>
    LinkedList<span class="token operator">&lt;</span>Storage<span class="token operator">></span> storageList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token operator">&lt;</span>Storage<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 创建数据中心特征，它表示了数据中心的资源的静态属性，比如：体系结构，操作系统，主机列表，分配策略，时间或空间共享，时区，价格</span>
    DatacenterCharacteristics characteristics <span class="token operator">=</span>
    <span class="token keyword">new</span> <span class="token class-name">DatacenterCharacteristics</span><span class="token punctuation">(</span>arch<span class="token punctuation">,</span> os<span class="token punctuation">,</span> vmm<span class="token punctuation">,</span>hostList<span class="token punctuation">,</span>
        time_zone<span class="token punctuation">,</span>cost<span class="token punctuation">,</span>costPerMem<span class="token punctuation">,</span>costPerStorage<span class="token punctuation">,</span> costPerBw<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// .最后，创建Power-aware数据中心</span>
    Datacenter datacenter <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        datacenter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Datacenter</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> characteristics<span class="token punctuation">,</span>
            <span class="token keyword">new</span>  <span class="token class-name">VmAllocationPolicySimple</span><span class="token punctuation">(</span>hostList<span class="token punctuation">)</span><span class="token punctuation">,</span> storageList<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> datacenter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a>第三步</h3><p>一个 Datacenterbroker 实例被创建，创建代理</p>
<pre class=" language-java"><code class="language-java">DatacenterBroker broker <span class="token operator">=</span> <span class="token function">createBroker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>这反过来将调用发送到 createBroker（）方法的以下定义：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> DatacenterBroker <span class="token function">createBroker</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    DatacenterBroker broker <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        broker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatacenterBroker</span><span class="token punctuation">(</span><span class="token string">"Broker"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> null<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//in case of error it will return null object.</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> broker<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="第四步"><a href="#第四步" class="headerlink" title="第四步"></a>第四步</h3><p>创建一个虚拟机列表，然后再创建一个虚拟机，并将虚拟机添加到虚拟机列表中，然后将虚拟机列表提交到数据中心代理中</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// Virtual Machine parameter description</span>
<span class="token keyword">int</span> vmid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> mips <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token keyword">long</span> size <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// image size (MB)</span>
<span class="token keyword">int</span> ram <span class="token operator">=</span> <span class="token number">512</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// vm memory (MB)</span>
<span class="token keyword">long</span> bw <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> pesNumber <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// number of cpus</span>
String vmm <span class="token operator">=</span> <span class="token string">"Xen"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// VMM name</span>
<span class="token comment" spellcheck="true">// create VM model class instance</span>
Vm vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vm</span><span class="token punctuation">(</span>vmid<span class="token punctuation">,</span>brokerId<span class="token punctuation">,</span> mips<span class="token punctuation">,</span>
                pesNumber<span class="token punctuation">,</span> ram<span class="token punctuation">,</span> bw<span class="token punctuation">,</span>
                size<span class="token punctuation">,</span> vmm<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">CloudletSchedulerTimeShared</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// add the VM to the vmList, which was declared in start of the class as class variable</span>
vmlist<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// submit vm list to the broker instance created in step 3.</span>
broker<span class="token punctuation">.</span><span class="token function">submitVmList</span><span class="token punctuation">(</span>vmlist<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="第五步"><a href="#第五步" class="headerlink" title="第五步"></a>第五步</h3><p>创建云任务列表，创建云任务，将云任务添加到列表中，将云任务列表提交给数据中心代理</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// Cloudlet properties</span>
<span class="token keyword">int</span> id <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">long</span> length <span class="token operator">=</span> <span class="token number">400000</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// estimated instruction length of your workload</span>
<span class="token keyword">long</span> fileSize <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// input size of the file used for the calculation of bandwidth</span>
<span class="token keyword">long</span> outputSize <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//output size of the file used for the calculation of bandwidth</span>

<span class="token comment" spellcheck="true">//this defines how much compute capacity of allocated resource can be consumed by a cloudlet.</span>
UtilizationModel utilizationModel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UtilizationModelFull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//New instance of cloudlet is created</span>
Cloudlet cloudlet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cloudlet</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> length<span class="token punctuation">,</span> pesNumber<span class="token punctuation">,</span>
                    fileSize<span class="token punctuation">,</span> outputSize<span class="token punctuation">,</span> utilizationModel<span class="token punctuation">,</span>
                    utilizationModel<span class="token punctuation">,</span> utilizationModel<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//set to be executed through the specific broker</span>
cloudlet<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>brokerId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/*
Defines on which VM does this cloudlet is going to be executed during the simulation.
The vmid used here is the one defined during step 4.
*/</span>
cloudlet<span class="token punctuation">.</span><span class="token function">setVmId</span><span class="token punctuation">(</span>vmid<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// add the cloudlet to the list</span>
cloudletList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>cloudlet<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// submit cloudlet list to the broker</span>
broker<span class="token punctuation">.</span>submitCloudletList\<span class="token punctuation">(</span>cloudletList\<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="第六步"><a href="#第六步" class="headerlink" title="第六步"></a>第六步</h3><p>开始模拟，结束模拟</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*
Simulation started here after all teh configurations are set.
The method calls initiate all the entities and their events
are started scheduling, then each event entity processes
its scheduled tasks. Once all the scheduled tasks are over
the call for this method is over.
*/</span>
CloudSim<span class="token punctuation">.</span><span class="token function">startSimulation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/*
Once the startsimulation() method call is over and
it there is no error occured then immdeiatly after
that the stopsimulation() method is call.
This method is going to stop all the entities
and returns the control to main method.
*/</span>
CloudSim<span class="token punctuation">.</span><span class="token function">stopSimulation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="第七步"><a href="#第七步" class="headerlink" title="第七步"></a>第七步</h3><p>输出结果</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//Final step: Print results when simulation is over</span>
List<span class="token operator">&lt;</span>Cloudlet<span class="token operator">></span> newList <span class="token operator">=</span> broker<span class="token punctuation">.</span><span class="token function">getCloudletReceivedList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printCloudletList</span><span class="token punctuation">(</span>newList<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>这反过来调用 printCloudletList 方法，如下所示：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printCloudletList</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Cloudlet<span class="token operator">></span> list<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> size <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Cloudlet cloudlet<span class="token punctuation">;</span>

    String indent <span class="token operator">=</span> <span class="token string">"    "</span><span class="token punctuation">;</span>
    Log<span class="token punctuation">.</span><span class="token function">printLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Log<span class="token punctuation">.</span><span class="token function">printLine</span><span class="token punctuation">(</span><span class="token string">"========== OUTPUT =========="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Log<span class="token punctuation">.</span><span class="token function">printLine</span><span class="token punctuation">(</span><span class="token string">"Cloudlet ID"</span> <span class="token operator">+</span> indent <span class="token operator">+</span> <span class="token string">"STATUS"</span> <span class="token operator">+</span> indent
                <span class="token operator">+</span> <span class="token string">"Data center ID"</span> <span class="token operator">+</span> indent <span class="token operator">+</span> <span class="token string">"VM ID"</span> <span class="token operator">+</span> indent <span class="token operator">+</span> <span class="token string">"Time"</span> <span class="token operator">+</span> indent
                <span class="token operator">+</span> <span class="token string">"Start Time"</span> <span class="token operator">+</span> indent <span class="token operator">+</span> <span class="token string">"Finish Time"</span><span class="token operator">+</span> indent <span class="token operator">+</span> <span class="token string">"End Waiting Time"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    DecimalFormat dft <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"###.##"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cloudlet <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Log<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>indent <span class="token operator">+</span> cloudlet<span class="token punctuation">.</span><span class="token function">getCloudletId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> indent <span class="token operator">+</span> indent<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>cloudlet<span class="token punctuation">.</span><span class="token function">getCloudletStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Cloudlet<span class="token punctuation">.</span>SUCCESS<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Log<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"SUCCESS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            Log<span class="token punctuation">.</span><span class="token function">printLine</span><span class="token punctuation">(</span>indent <span class="token operator">+</span> indent <span class="token operator">+</span> cloudlet<span class="token punctuation">.</span><span class="token function">getResourceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token operator">+</span> indent <span class="token operator">+</span> indent <span class="token operator">+</span> indent <span class="token operator">+</span> cloudlet<span class="token punctuation">.</span><span class="token function">getVmId</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token operator">+</span> indent <span class="token operator">+</span> indent
                        <span class="token operator">+</span> dft<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cloudlet<span class="token punctuation">.</span><span class="token function">getActualCPUTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> indent
                        <span class="token operator">+</span> indent <span class="token operator">+</span> dft<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cloudlet<span class="token punctuation">.</span><span class="token function">getExecStartTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token operator">+</span> indent <span class="token operator">+</span> indent
                        <span class="token operator">+</span> dft<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cloudlet<span class="token punctuation">.</span><span class="token function">getFinishTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span> indent <span class="token operator">+</span> indent
                        <span class="token operator">+</span> cloudlet<span class="token punctuation">.</span><span class="token function">getUtilizationModelCpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>这最终打印出云资源在其各自资源（即 DataCenter，Broker，虚拟机等）上的执行状态。在模拟过程中，状态日志会在各种情况下打印，完整的日志可能与“ CloudSimExample1.java ” 类似。</p>
<pre class=" language-text"><code class="language-text">Starting CloudSimExample1...  
Initialising...  
Starting CloudSim version 3.0  
Datacenter\_0 is starting...  
Broker is starting...  
Entities started.  
0.0: Broker: Cloud Resource List received with 1 resource\(s\)  
0.0: Broker: Trying to Create VM \#0 in Datacenter\_0  
0.1: Broker: VM \#0 has been created in Datacenter \#2, Host \#0  
0.1: Broker: Sending cloudlet 0 to VM \#0  
400.1: Broker: Cloudlet 0 received  
400.1: Broker: All Cloudlets executed. Finishing...  
400.1: Broker: Destroying VM \#0  
Broker is shutting down...  
Simulation: No more future events  
CloudInformationService: Notify all CloudSim entities for shutting down.  
Datacenter\_0 is shutting down...  
Broker is shutting down...  
Simulation completed.  
Simulation completed.

========== OUTPUT ==========  
Cloudlet ID    STATUS    Data center ID    VM ID    Time    Start Time    Finish Time  
    0        SUCCESS        2            0        400        0.1        400.1  
CloudSimExample1 finished!
</code></pre>
<h2 id="CloudSim-的拓展"><a href="#CloudSim-的拓展" class="headerlink" title="CloudSim 的拓展"></a>CloudSim 的拓展</h2><p>(ps:算法来自网络)<br>CloudSim 主要是对真实的云环境的一种模拟仿真，其各个类分别模拟了云计算的资源分配的各个过程，包括虚拟机向物理机的分配过程，计算任务向虚拟机的分配过程等等，这些分配策略分别在不同的 class 中进行了描述。由于 CloudSim 只是搭建了一个云数据中心的框架，因此具体的分配策略需要我们自己去实现，也就需要去在相应的 Class 中添加自己的策略函数。在 CloudSim 给的 examples 中，给运任务分配虚拟机的时候，使用的函数是<br><code>broker.bindCloudletToVm(cloudlet1.getCloudletId(),vm1.getId());</code><br>,我们可以跟进去发现，该函数是在<br><code>DatacenterBroker.java</code>中，该函数使用的是直接绑定的策略，即程序中指定了云任务和虚拟机的绑定方式，如果我们需要使用自己的分配策略，就得在 <code>DatacenterBroker.java</code> 中添加自己的分配策略函数。下面分别使用两种分配策略对云任务进行分配虚拟机，分别为顺序分配策略和贪心分配策略：</p>
<h2 id="顺序分配策略"><a href="#顺序分配策略" class="headerlink" title="顺序分配策略"></a>顺序分配策略</h2><p>在 DatacenterBroker 类中实现方法 bindCloudletsToVmsSimple()：用于把一组任务顺序分配给一组虚拟机，当所有的虚拟机都运行有任务后，再从第一个虚拟机开始重头分配任务。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">bindCloudletsToVmsSimple</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> vmNum <span class="token operator">=</span> vmList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> cloudletNum <span class="token operator">=</span> cloudletList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cloudletNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cloudletList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setVmId</span><span class="token punctuation">(</span>vmList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            idx <span class="token operator">=</span> <span class="token punctuation">(</span>idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> vmNum<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h2 id="贪心策略"><a href="#贪心策略" class="headerlink" title="贪心策略"></a>贪心策略</h2><p>在<code>DatacenterBroker</code>类中实现方法<code>bindCloudletsToVmsTimeAwared()</code>：定义一个矩阵 time[i][j]，表示任务 i 在虚拟机 j 上所需的执行时间。在初始化矩阵 time 前，首先将任务按 MI 的大小降序排序，将虚拟机按 MIPS 的大小升序排列。从矩阵中行号为 0 的任务开始，每次都尝试分配给最后一列对应的虚拟机，如果该选择相对于其他选择是最优的，就完成分配，否则将任务分配给使当前结果最优的虚拟机。同时，如果有多种分配方法都能使当前结果最优，则将任务分配给运行任务最少的虚拟机。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">bindCloudletsToVmsTimeAwared</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> cloudletNum <span class="token operator">=</span> cloudletList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> vmNum <span class="token operator">=</span> vmList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// time[i][j] 表示任务i在虚拟机j上的执行时间</span>
        <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">double</span><span class="token punctuation">[</span>cloudletNum<span class="token punctuation">]</span><span class="token punctuation">[</span>vmNum<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// cloudletList按MI降序排列, vm按MIPS升序排列</span>
        Collections<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>cloudletList<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">CloudletComparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Collections<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>vmList<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">VmComparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// ////////For test//////////////////////////////////</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"///////////For test///////////////"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cloudletNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>cloudletList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCloudletId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> cloudletList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCloudletLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> vmNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>vmList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span>
                    <span class="token operator">+</span> vmList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMips</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"//////////////////////////////////"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// ////////////////////////////////////////////////////////////////////</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cloudletNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> vmNum<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                time<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> cloudletList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCloudletLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token operator">/</span> vmList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMips</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"time["</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">"]["</span> <span class="token operator">+</span> j <span class="token operator">+</span> <span class="token string">"]="</span> <span class="token operator">+</span> time<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
                        <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// For test</span>
            <span class="token punctuation">}</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// For test</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> vmLoad <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">double</span><span class="token punctuation">[</span>vmNum<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 在某个虚拟机上任务的总执行时间</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> vmTasks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>vmNum<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 在某个Vm上运行的任务数量</span>
        <span class="token keyword">double</span> minLoad <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 记录当前任务分配方式的最优值</span>
        <span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 记录当前任务最优分配方式对应的虚拟机列号</span>
        <span class="token comment" spellcheck="true">// 第一个cloudlet分配给最快的vm</span>
        vmLoad<span class="token punctuation">[</span>vmNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> time<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>vmNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        vmTasks<span class="token punctuation">[</span>vmNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        cloudletList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setVmId</span><span class="token punctuation">(</span>vmList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>vmNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cloudletNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            minLoad <span class="token operator">=</span> vmLoad<span class="token punctuation">[</span>vmNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> time<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>vmNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            idx <span class="token operator">=</span> vmNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> vmNum <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> j <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// 如果当前虚拟机未分配任务，则比较完当前任务分配给该虚拟机是否最优</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>vmLoad<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>minLoad <span class="token operator">>=</span> time<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
                        idx <span class="token operator">=</span> j<span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>minLoad <span class="token operator">></span> vmLoad<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> time<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    minLoad <span class="token operator">=</span> vmLoad<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> time<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    idx <span class="token operator">=</span> j<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment" spellcheck="true">// 简单的负载均衡</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>minLoad <span class="token operator">==</span> vmLoad<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> time<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
                        <span class="token operator">&amp;&amp;</span> vmTasks<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> vmTasks<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    idx <span class="token operator">=</span> j<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            vmLoad<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">+=</span> time<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">;</span>
            vmTasks<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
            cloudletList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setVmId</span><span class="token punctuation">(</span>vmList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">"th "</span> <span class="token operator">+</span> <span class="token string">"vmLoad["</span> <span class="token operator">+</span> idx <span class="token operator">+</span> <span class="token string">"]="</span> <span class="token operator">+</span> vmLoad<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
                    <span class="token operator">+</span> <span class="token string">"minLoad="</span> <span class="token operator">+</span> minLoad<span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>如果想实现自定义任务绑定，可以自行编写 CloudletList-&gt;VmList 的映射函数，以某种方式完成任务列表中的所有 Cloudlet 的绑定工作。然后在模拟程序中，vm 列表和 cloudlet 列表提交之后调用该自定义函数，即可完成所有任务的绑定（这样自然就不需要自带的轮转法代劳了）。下面采用一种改进型轮转法来绑定任务，长任务尽量优先分配到高性能 VM 上。</p>
<blockquote>
<p>插入到 DatacenterBroker 类中</p>
</blockquote>
<pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Collections<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Comparator
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">bindCloudletsToVmsRRImproved</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">int</span> vmNum<span class="token operator">=</span>vmList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> cloudletNum<span class="token operator">=</span>cloudletList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 任务按指令长度降序，Vm按性能降序，需要导入包 java.util.Collections</span>
Collections<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>cloudletList<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">CloudletComparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  Collections<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>vmList<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">VmComparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> idx<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>cloudletNum<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token comment" spellcheck="true">//将任务绑定到指定 id 的虚拟机，按Round-Robin轮转法</span>
 <span class="token function">bindCloudletToVm</span><span class="token punctuation">(</span>vmList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cloudletList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCloudletId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 idx<span class="token operator">=</span><span class="token punctuation">(</span>idx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>vmNum<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//循环遍历虚拟机</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//根据指令长度降序排列任务，需要导入包 java.util.Comparator</span>
<span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">CloudletComparator</span> <span class="token keyword">implements</span> <span class="token class-name">Comparator</span><span class="token operator">&lt;</span>Cloudlet<span class="token operator">></span><span class="token punctuation">{</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span>Cloudlet cl1<span class="token punctuation">,</span>Cloudlet cl2<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>c12<span class="token punctuation">.</span><span class="token function">getCloudletLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>cl1<span class="token punctuation">.</span> <span class="token function">getCloudletLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//根据执行速度降序排列虚拟机</span>
<span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">VmComparator</span> <span class="token keyword">implements</span> <span class="token class-name">Comparator</span><span class="token operator">&lt;</span>Vm<span class="token operator">></span><span class="token punctuation">{</span>
 <span class="token annotation punctuation">@Override</span>
 <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span>Vm vm1<span class="token punctuation">,</span> Vm vm2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>vm2<span class="token punctuation">.</span><span class="token function">getMips</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> vm1<span class="token punctuation">.</span><span class="token function">getMips</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>写完两个分配策略函数，后面可以写一个测试函数，分别对这两种分配策略进行仿真实验，并进行对比。在<code>org.cloudbus.cloudsim.examples</code>中，写一个自己的<code>MyAllocationTest</code>类，其源码为：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAllocationTest</span> <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">/** The cloudlet list. */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> List<span class="token operator">&lt;</span>Cloudlet<span class="token operator">></span> cloudletList<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> cloudletNum <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/** The vmlist. */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> List<span class="token operator">&lt;</span>Vm<span class="token operator">></span> vmlist<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> vmNum <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
    * Creates main() to run this example
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        Log<span class="token punctuation">.</span><span class="token function">printLine</span><span class="token punctuation">(</span><span class="token string">"Starting TestAllocation..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// First step: Initialize the CloudSim package. It should be called</span>
            <span class="token comment" spellcheck="true">// before creating any entities.</span>
            <span class="token keyword">int</span> num_user <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// number of cloud users</span>
            Calendar calendar <span class="token operator">=</span> Calendar<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">boolean</span> trace_flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// mean trace events</span>

            <span class="token comment" spellcheck="true">// Initialize the CloudSim library</span>
            CloudSim<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>num_user<span class="token punctuation">,</span> calendar<span class="token punctuation">,</span> trace_flag<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// Second step: Create Datacenters</span>
            <span class="token comment" spellcheck="true">/*
             * Datacenters are the resource providers in CloudSim. We need at list one of
             *  them to run a CloudSim simulation
             */</span>
            Datacenter datacenter0 <span class="token operator">=</span> <span class="token function">createDatacenter</span><span class="token punctuation">(</span><span class="token string">"Datacenter_0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//Third step: Create Broker</span>
            DatacenterBroker broker <span class="token operator">=</span> <span class="token function">createBroker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> brokerId <span class="token operator">=</span> broker<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//VM description</span>
            <span class="token keyword">int</span> vmid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> mipss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">278</span><span class="token punctuation">,</span><span class="token number">289</span><span class="token punctuation">,</span><span class="token number">132</span><span class="token punctuation">,</span><span class="token number">209</span><span class="token punctuation">,</span><span class="token number">286</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">long</span> size <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> ram <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">;</span>
            <span class="token keyword">long</span> bw <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> pesNumber <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            String vmm <span class="token operator">=</span> <span class="token string">"Xen"</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//Fourth step: Create one virtual machine</span>
            vmlist <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>Vm<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>vmNum<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                vmlist<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Vm</span><span class="token punctuation">(</span>vmid<span class="token punctuation">,</span>brokerId<span class="token punctuation">,</span>mipss<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>pesNumber<span class="token punctuation">,</span>
                        ram<span class="token punctuation">,</span>bw<span class="token punctuation">,</span>size<span class="token punctuation">,</span>vmm<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">CloudletSchedulerSpaceShared</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                vmid<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment" spellcheck="true">//submit vm list to the broker</span>
            broker<span class="token punctuation">.</span><span class="token function">submitVmList</span><span class="token punctuation">(</span>vmlist<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//Cloudlet properties</span>
            <span class="token keyword">int</span> id <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> lengths <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">19365</span><span class="token punctuation">,</span><span class="token number">49809</span><span class="token punctuation">,</span><span class="token number">32018</span><span class="token punctuation">,</span><span class="token number">44157</span><span class="token punctuation">,</span><span class="token number">16754</span><span class="token punctuation">,</span>
                                        <span class="token number">18336</span><span class="token punctuation">,</span><span class="token number">20045</span><span class="token punctuation">,</span><span class="token number">31493</span><span class="token punctuation">,</span><span class="token number">30727</span><span class="token punctuation">,</span><span class="token number">31017</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">long</span> fileSize <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>
            <span class="token keyword">long</span> outputSize <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>
            UtilizationModel utilizationModel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UtilizationModelFull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//Fifth step: Create two Cloudlets</span>
            cloudletList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>Cloudlet<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> cloudletNum<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                Cloudlet cloudlet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cloudlet</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>lengths<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>pesNumber<span class="token punctuation">,</span>fileSize<span class="token punctuation">,</span>
                                    outputSize<span class="token punctuation">,</span>utilizationModel<span class="token punctuation">,</span>utilizationModel<span class="token punctuation">,</span>utilizationModel<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">//add the cloudlets to the list</span>
                cloudlet<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>brokerId<span class="token punctuation">)</span><span class="token punctuation">;</span>
                cloudletList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>cloudlet<span class="token punctuation">)</span><span class="token punctuation">;</span>
                id<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment" spellcheck="true">//submit cloudlet list to the broker</span>
            broker<span class="token punctuation">.</span><span class="token function">submitCloudletList</span><span class="token punctuation">(</span>cloudletList<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//bind the cloudlets to the vms. This way, the broker</span>
            <span class="token comment" spellcheck="true">// will submit the bound cloudlets only to the specific VM</span>
            <span class="token comment" spellcheck="true">// 下面是顺序算法 broker.bindCloudletsToVmsSimple();</span>
            broker<span class="token punctuation">.</span><span class="token function">bindCloudletsToVmsSimple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 下面是贪心算法broker.bindCloudletsToVmsTimeAwared();</span>
            <span class="token comment" spellcheck="true">//broker.bindCloudletsToVmsTimeAwared();</span>

            <span class="token comment" spellcheck="true">// Sixth step: Starts the simulation</span>
            CloudSim<span class="token punctuation">.</span><span class="token function">startSimulation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// Final step: Print results when simulation is over</span>
            List<span class="token operator">&lt;</span>Cloudlet<span class="token operator">></span> newList <span class="token operator">=</span> broker<span class="token punctuation">.</span><span class="token function">getCloudletReceivedList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            CloudSim<span class="token punctuation">.</span><span class="token function">stopSimulation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">printCloudletList</span><span class="token punctuation">(</span>newList<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">//Print the debt of each user to each datacenter</span>
            <span class="token comment" spellcheck="true">//datacenter0;</span>
            Log<span class="token punctuation">.</span><span class="token function">printLine</span><span class="token punctuation">(</span><span class="token string">"TestAllocation finished!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Log<span class="token punctuation">.</span><span class="token function">printLine</span><span class="token punctuation">(</span><span class="token string">"Unwanted errors happen"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     *
     * @Title: createDatacenter
     * @Description: TODO
     * @param: @param name
     * @param: @return
     * @return: Datacenter
     * @Date: May 17, 20167:16:32 PM
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> Datacenter <span class="token function">createDatacenter</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// Here are the steps needed to create a PowerDatacenter:</span>

        <span class="token comment" spellcheck="true">// 1. We need to create a list to store</span>
        <span class="token comment" spellcheck="true">// our machine</span>
        List<span class="token operator">&lt;</span>Host<span class="token operator">></span> hostList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>Host<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// PE and its properties</span>
        <span class="token keyword">int</span> mips <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> hostId<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> ram <span class="token operator">=</span> <span class="token number">2048</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//host memory (MB)</span>
        <span class="token keyword">long</span> storage <span class="token operator">=</span> <span class="token number">1000000</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//host storage</span>
        <span class="token keyword">int</span> bw <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 2. A Machine contains one or more PEs or CPUs/Cores.</span>
        List<span class="token operator">&lt;</span>Pe<span class="token operator">></span> peList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>Pe<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 3. Create PEs and add these into a list.</span>
        peList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Pe</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PeProvisionerSimple</span><span class="token punctuation">(</span>mips<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// need to store Pe id and MIPS Rating</span>

        <span class="token comment" spellcheck="true">//4. Create Host with its id and list of PEs and add them to the list of machines</span>
        hostList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name">Host</span><span class="token punctuation">(</span>
                hostId<span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">RamProvisionerSimple</span><span class="token punctuation">(</span>ram<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">BwProvisionerSimple</span><span class="token punctuation">(</span>bw<span class="token punctuation">)</span><span class="token punctuation">,</span>
                storage<span class="token punctuation">,</span>
                peList<span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">VmSchedulerTimeShared</span><span class="token punctuation">(</span>peList<span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// This is our machine</span>

        <span class="token comment" spellcheck="true">// 5. Create a DatacenterCharacteristics object that stores the</span>
        <span class="token comment" spellcheck="true">// properties of a data center: architecture, OS, list of</span>
        <span class="token comment" spellcheck="true">// Machines, allocation policy: time- or space-shared, time zone</span>
        <span class="token comment" spellcheck="true">// and its price (G$/Pe time unit).</span>

        String arch <span class="token operator">=</span> <span class="token string">"x86"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// system architecture</span>
        String os <span class="token operator">=</span> <span class="token string">"Linux"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// operating system</span>
        String vmm <span class="token operator">=</span> <span class="token string">"Xen"</span><span class="token punctuation">;</span>
        <span class="token keyword">double</span> time_zone <span class="token operator">=</span> <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// time zone this resource located</span>
        <span class="token keyword">double</span> cost <span class="token operator">=</span> <span class="token number">3.0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// the cost of using processing in this resource</span>
        <span class="token keyword">double</span> costPerMem <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// the cost of using memory in this resource</span>
        <span class="token keyword">double</span> costPerStorage <span class="token operator">=</span> <span class="token number">0.001</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// the cost of using storage in this resource</span>
        <span class="token keyword">double</span> costPerBw <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// the cost of using bw in this resource</span>
        LinkedList<span class="token operator">&lt;</span>Storage<span class="token operator">></span> storageList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token operator">&lt;</span>Storage<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//we are not adding SAN devices by now</span>
        <span class="token comment" spellcheck="true">//创建数据中心特征对象</span>
        DatacenterCharacteristics characteristics <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatacenterCharacteristics</span><span class="token punctuation">(</span> arch<span class="token punctuation">,</span> os<span class="token punctuation">,</span> vmm<span class="token punctuation">,</span>
                hostList<span class="token punctuation">,</span> time_zone<span class="token punctuation">,</span> cost<span class="token punctuation">,</span> costPerMem<span class="token punctuation">,</span> costPerStorage<span class="token punctuation">,</span> costPerBw<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 6. Finally, we need to create a PowerDatacenter object.</span>
        Datacenter datacenter <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            datacenter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Datacenter</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> characteristics<span class="token punctuation">,</span>
                    <span class="token keyword">new</span> <span class="token class-name">VmAllocationPolicySimple</span><span class="token punctuation">(</span>hostList<span class="token punctuation">)</span><span class="token punctuation">,</span> storageList<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> datacenter<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/*
     * We strongly encourage users to develop their own broker policies, to submit vms and cloudlets
     * according to the specific rules of the simulated scenario
     */</span>

    <span class="token comment" spellcheck="true">/**
     *
     * @Title: createBroker
     * @Description: TODO
     * @param: @return
     * @return: DatacenterBroker
     * @Date: May 17, 20167:17:32 PM
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> DatacenterBroker <span class="token function">createBroker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        DatacenterBroker broker <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            broker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatacenterBroker</span><span class="token punctuation">(</span><span class="token string">"Broker"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> null<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> broker<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printCloudletList</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Cloudlet<span class="token operator">></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> size <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Cloudlet cloudlet<span class="token punctuation">;</span>
        String indent <span class="token operator">=</span> <span class="token string">" "</span><span class="token punctuation">;</span>
        Log<span class="token punctuation">.</span><span class="token function">printLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Log<span class="token punctuation">.</span><span class="token function">printLine</span><span class="token punctuation">(</span><span class="token string">"========== OUTPUT =========="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Log<span class="token punctuation">.</span><span class="token function">printLine</span><span class="token punctuation">(</span><span class="token string">"CloudletID"</span> <span class="token operator">+</span> indent <span class="token operator">+</span> <span class="token string">"STATUS"</span> <span class="token operator">+</span> indent <span class="token operator">+</span>
                        <span class="token string">"DatacenterID"</span> <span class="token operator">+</span> indent <span class="token operator">+</span> <span class="token string">"VMID"</span> <span class="token operator">+</span> indent <span class="token operator">+</span>
                        <span class="token string">"Time"</span> <span class="token operator">+</span> indent <span class="token operator">+</span> <span class="token string">"StartTime"</span> <span class="token operator">+</span> indent <span class="token operator">+</span> <span class="token string">"FinishTime"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        DecimalFormat dft <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DecimalFormat</span><span class="token punctuation">(</span><span class="token string">"###.##"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            cloudlet <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Log<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>indent <span class="token operator">+</span> cloudlet<span class="token punctuation">.</span><span class="token function">getCloudletId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> indent <span class="token operator">+</span> indent<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cloudlet<span class="token punctuation">.</span><span class="token function">getCloudletStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Cloudlet<span class="token punctuation">.</span>SUCCESS<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Log<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"SUCCESS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Log<span class="token punctuation">.</span><span class="token function">printLine</span><span class="token punctuation">(</span> indent <span class="token operator">+</span> indent <span class="token operator">+</span> cloudlet<span class="token punctuation">.</span><span class="token function">getResourceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                                indent <span class="token operator">+</span> indent <span class="token operator">+</span> indent <span class="token operator">+</span> cloudlet<span class="token punctuation">.</span><span class="token function">getVmId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> indent <span class="token operator">+</span> indent <span class="token operator">+</span>
                                dft<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cloudlet<span class="token punctuation">.</span><span class="token function">getActualCPUTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> indent <span class="token operator">+</span> indent <span class="token operator">+</span>
                                dft<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cloudlet<span class="token punctuation">.</span><span class="token function">getExecStartTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span> indent <span class="token operator">+</span> indent <span class="token operator">+</span>
                                dft<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>cloudlet<span class="token punctuation">.</span><span class="token function">getFinishTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>在主函数中，分别调用函数<br><code>broker.bindCloudletsToVmsSimple()</code>和<code>broker.bindCloudletsToVmsTimeAwared()</code>，表示分别启动顺序分配策略和贪心策略，其运行结果分别为：<br><img src="https://i.imgur.com/1TVhlVE.png" alt><br><img src="https://i.imgur.com/9rOm9vw.png" alt></p>
<p>贪心算法见下一篇博客</p>

            </div>
            <hr>

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">
                        <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;转载请注明:
                    </span>
                    <a href="https://joshgad.github.io" class="b-link-green">七月飞雪</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/20171229/cloudsim-configuration.html" class="b-link-green">cloudsim 配置</a>
                </p>
            </div>
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6 overflow-policy" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/20180227/jquery-ajax-method.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/22.jpg" class="responsive-img" alt="jQuery ajax方法">
                        
                        <span class="card-title">jQuery ajax方法</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">jquery中的ajax方法参数总是记不住，这里记录一下。 1.url: 
要求为String类型的参数，（默认为当前页地址）发送请求的地址。
2.type:要求为String类型的参数，请求方式（post或get）默认为get。注意其他h</div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2018-02-27
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/前端-js/" class="post-category" target="_blank">
                                    前端,js
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Programming/" target="_blank">
                        <span class="chip bg-color">Programming</span>
                    </a>
                    
                    <a href="/tags/JavaScript/" target="_blank">
                        <span class="chip bg-color">JavaScript</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6 overflow-policy" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/20171229/how-are-you.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="贪心算法">
                        
                        <span class="card-title">贪心算法</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">贪心算法总结贪心算法贪心算法（又称贪婪算法）是指，在对问题求解时，总是做出在当前看来是最好的选择。也就是说，不从整体最优上加以考虑，他所做出的是在某种意义上的局部最优解。贪心算法不是对所有问题都能得到整体最优解，关键是贪心策略的选择，选择的</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2017-12-29
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/编程/" class="post-category" target="_blank">
                                    编程
                                </a>
                            
                            <a href="/categories/编程/算法/" class="post-category" target="_blank">
                                    算法
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/编程/" target="_blank">
                        <span class="chip bg-color">编程</span>
                    </a>
                    
                    <a href="/tags/电脑/" target="_blank">
                        <span class="chip bg-color">电脑</span>
                    </a>
                    
                    <a href="/tags/算法/" target="_blank">
                        <span class="chip bg-color">算法</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            本站由&copy;<a href="https://blinkfox.github.io/" target="_blank">Blinkfox</a>基于
            <a href="https://hexo.io/" target="_blank">Hexo</a> 的
            <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">hexo-theme-matery</a>主题搭建.

            

            
			
                <br>
                
                <span id="busuanzi_container_site_pv">
                    <i class="fa fa-heart-o"></i>
                    本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
                </span>
                
                
                <span id="busuanzi_container_site_uv">
                    <i class="fa fa-users"></i>
                    次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                </span>
                
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">


    <a href="mailto:xxx@xx.xx" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=123123123" class="tooltipped" data-tooltip="QQ联系我: 123123123" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>


</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->



    <script src="/libs/others/clicklove.js"></script>


    <script async src="/libs/others/busuanzi.pure.mini.js"></script>


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/live2d-widget","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":200,"height":400},"mobile":{"show":true},"log":false});</script></body>
</html>